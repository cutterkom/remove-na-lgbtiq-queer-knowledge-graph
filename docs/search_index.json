[["index.html", "Misc About Creating a LGBTIQ* Knowledge Graph 1 Intro 1.1 Virtual Environments and dependency management", " Misc About Creating a LGBTIQ* Knowledge Graph Katharina Brunner 3/21/2022 1 Intro I will be allowed to spend a larger part of 2022 building a Knowledge Graph on queer history. This page will serve as the technical documentation. 1.1 Virtual Environments and dependency management Python venv R: renv.lock (one has to activate it with renv::activate()), see more in docs "],["data-gathering.html", "2 Data Gathering 2.1 Infrastructure 2.2 Citavi data dumps 2.3 Entity Resolution 2.4 New database with cleaned entries", " 2 Data Gathering The first step is to merge different data sources. The scripts for this can be found in the repo under data-gathering. 2.1 Infrastructure 2.1.1 MariaDB Initial converted data from Citavi and other sources are stored in a MariaDB. Install and setup on Mac with homebrew. CREATE DATABASE lgbtiq_kg CHARACTER SET = &#39;utf8&#39; COLLATE = &#39;utf8_german2_ci&#39;; FLUSH PRIVILEGES; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;NEW_PASSWORD&#39;; 2.2 Citavi data dumps Scripts: data-gathering/from-citavi/ There are three exports from Citavi data dumps that are normalized: poster, books, digital. All three are stored in a MariaDB. Naming convention: plurale: data -&gt; books_years singular: relations -&gt; book_years: relationship between book_id and year_id 2.2.1 Books data model books data model 2.2.2 Poster data model poster data model 2.2.3 Views 2.2.3.1 Books A wide view on all books CREATE VIEW books_wide AS SELECT books.book_id, books_authors.author_id, books_editors.editor_id, books_locations.location_id, books_publishers.publisher_id, books_series.series_id, books_years.year_id, books.name, books_authors.author, books.isbn, books.subtitle, books.title_supplement, books_editors.editor, books_locations.location, books_publishers.publisher, books_series.series, books_years.year FROM books -- add authors LEFT JOIN book_author ON books.book_id = book_author.book_id LEFT JOIN books_authors ON book_author.author_id = books_authors.author_id -- add editors LEFT JOIN book_editor ON books.book_id= book_editor.book_id LEFT JOIN books_editors ON book_editor.editor_id = books_editors.editor_id -- add locatiONs LEFT JOIN book_locatiON ON books.book_id= book_locatiON.book_id LEFT JOIN books_locatiONs ON book_locatiON.locatiON_id = books_locatiONs.locatiON_id -- add publishers LEFT JOIN book_publisher ON books.book_id= book_publisher.book_id LEFT JOIN books_publishers ON book_publisher.publisher_id = books_publishers.publisher_id -- add series LEFT JOIN book_series ON books.book_id= book_series.book_id LEFT JOIN books_series ON book_series.series_id = books_series.series_id -- add years LEFT JOIN book_year ON books.book_id= book_year.book_id LEFT JOIN books_years ON book_year.year_id = books_years.year_id; 2.2.3.2 Posters Wide View on posters data. CREATE VIEW posters_wide AS SELECT posters.poster_id, posters_authors.author_id, posters_years.year_id, posters_keywords.keyword_id, posters.title, posters.size, posters_authors.author, posters_years.year, posters_keywords.keyword FROM posters -- add authors LEFT JOIN poster_author ON posters.poster_id = poster_author.poster_id LEFT JOIN posters_authors ON posters_authors.author_id = poster_author.author_id -- add years LEFT JOIN poster_year ON posters.poster_id = poster_year.poster_id LEFT JOIN posters_years ON posters_years.year_id = poster_year.year_id -- add keywords LEFT JOIN poster_keyword ON posters.poster_id = poster_keyword.poster_id LEFT JOIN posters_keywords ON posters_keywords.keyword_id = poster_keyword.keyword_id ; 2.3 Entity Resolution Deduplication, entitiy resolultion, entity linking etc. is a main and re-accuring task in this project. A first setup to tackle the task is two-fold: Calculate text similarities between entitity stings based on cosine similarity Human decision making 2.3.1 Calculate text similarities between entitity stings based on cosine similarity based on quanteda scripts under data-gathering/entity-resolution cosine minimum similiarty is set to 0.75 (for authors and publishers from posters and books) 2.3.2 Human decision making Shiny app called “Who is Who?” to show possible matching candidates decision by button clicking code in apps/entity-resolver results saved in er_candidates 2.3.2.1 Adding new candidates To update the Shiny app in order to resolve new candidates these two steps are needed: get new additional_infos in get-additional-infos.R add new source to get_candidates_names() 2.4 New database with cleaned entries In lgbtiq_kg_clean live all deduplicated entities. So to say the end result of all scripts in data-gathering/entitiy-resolution View books_wide: CREATE VIEW books_wide AS SELECT entities.id, books_authors.book_id, entities.name, books.name AS title, books.subtitle, books.isbn FROM entities INNER JOIN books_authors ON entities.id = books_authors.id LEFT JOIN books ON books.book_id = books_authors.book_id; View psoters_wide: CREATE VIEW posters_wide AS SELECT DISTINCT entities.id, posters_authors.poster_id, entities.name, posters.title, posters.short_title, posters.filename, posters.size, posters_years.year FROM entities INNER JOIN posters_authors ON entities.id = posters_authors.id LEFT JOIN posters ON posters.poster_id = posters_authors.poster_id LEFT JOIN posters_years ON posters.poster_id = posters_years.year_id;; View entities_per_type: Which entity appears where? CREATE VIEW entities_per_type AS SELECT entities.id, entities.name, books_authors.book_id, posters_authors.poster_id FROM entities LEFT JOIN books_authors ON entities.id = books_authors.id LEFT JOIN posters_authors ON entities.id = posters_authors.id; "],["data-modelling.html", "3 Data Modelling 3.1 Create RDF files from database", " 3 Data Modelling In this document you’ll find explainations and descriptions of the data model used in the Remove NA project. Remove NA collects data about real world entities, such as people, organizations or locations, and the relationships between them. 3.1 Create RDF files from database RDF files created with RML rules. Scripts in data-modelling run parser: Knowledge Graph v1 with de-duplicated books, authors, publishers (best version!): yarrrml-parser -i mappings/kg_v1.yml -o mappings/kg_v1.r2rml.ttl -f R2RML for posters: yarrrml-parser -i mappings/posters-rules.yml -o mappings/posters-mapping.r2rml.ttl -f R2RML for books: yarrrml-parser -i mappings/books-rules.yml -o mappings/books-mapping.r2rml.ttl -f R2RML for books and authors yarrrml-parser -i mappings/books-authors.yml -o mappings/books-authors.r2rml.ttl -f R2RML create RDF files with python3 create-rdf.py "],["data-linking.html", "4 Data Linking 4.1 GND/lobid 4.2 VIAF", " 4 Data Linking The internal data are linked to various external data sources. Main database table el_matches. Idea is to just dump everything there in a first step. CREATE TABLE `el_matches` ( `created_at` timestamp NULL DEFAULT current_timestamp(), `updated_at` timestamp NULL DEFAULT NULL ON UPDATE current_timestamp(), `entity_id` varchar(55) NOT NULL, `entity_id_type` varchar(255) DEFAULT NULL, `entity_id_combination` varchar(255) DEFAULT NULL, `entity_id_combination_type` varchar(255) DEFAULT NULL, `external_id` varchar(255) DEFAULT NULL, `external_id_label` varchar(255) DEFAULT NULL, `external_id_type` varchar(55) NOT NULL, `external_id_desc` varchar(255) DEFAULT NULL, `source` varchar(255) DEFAULT NULL, `source_id` longtext DEFAULT NULL, `property_type` varchar(255) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4; 4.1 GND/lobid I want to link the entities, like a book author or publisher, to the external identifier of the German National Library (GND). The easiest way seems to be calling the lobid API. It returns a json with meta data, e.g. contributors or topics that often, but not always, have a GND id. I filter the json file by using jq, a json processor, that has a wrapper in R: jqr. 4.1.1 Output DB tbl: lgbtiq_kg.el_matches beware: it’s not cleaned data, so not in “clean” database lgbtiq_kg_clean 4.1.2 jq commands: getting contributors: .member[].contribution[]? | {type: .agent?.type[], label: .agent?.label, role:.role?.id, gnd_id: .agent?.gndIdentifier} getting topics: .member[].subject[].componentList[]? | {gnd_id: select(.type?).gndIdentifier, type: select(.gndIdentifier?).type[], label: select(.type?).label} getting lobid ressource id: .member[] | {source_id: .id} 4.1.3 Basic workflow search for isbn the most precise way, because it’s already a persistent id data-linking/lobid/01-search-via-isbn.R script first version search for author name and title in the relevant objects query like contribution.agent.label:AUTHOR+AND+title: TITLE&amp;format=json\") data-linking/lobid/02-search-via-author-title.R search just by name data-linking/lobid/03-search-via-author.R 4.1.4 Caveats Example book_id == 2988 https://lobid.org/resources/search?q=contribution.agent.label:Valerie%20Miner+AND+title:mord%20auf%20dem%20campus&amp;format=json&amp;format=json title wrong -&gt; totally wrong books -&gt; topics are not allowed to be considered https://lobid.org/resources/search?q=contribution.agent.label:Valerie%20Miner&amp;format=json&amp;format=json finds the right person, 4.2 VIAF To VIAF by using the viafr R-package. It suggest a VIAF entity when providing a string. db table: el_viaf_books_authors "],["misc.html", "5 Misc", " 5 Misc Render docs: bookdown::render_book(\"docs/\", output_dir = \".\") "]]
